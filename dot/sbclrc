;;; The following lines added by ql:add-to-init-file:
#-quicklisp
(let ((quicklisp-init (merge-pathnames "lisp/setup.lisp"
                                       (user-homedir-pathname))))
  (when (probe-file quicklisp-init)
    (load quicklisp-init)))

;;; Check for --no-linedit command-line option.
(if (member "--no-linedit" sb-ext:*posix-argv* :test 'equal)
  (setf sb-ext:*posix-argv* 
        (remove "--no-linedit" sb-ext:*posix-argv* :test 'equal))
  (when (interactive-stream-p *terminal-io*)
    (require 'sb-aclrepl)
    (asdf:load-system :linedit)
    (funcall (intern "INSTALL-REPL" :linedit) :wrap-current t :eof-quits t 
             :history "~/.linedit_history")

    (ignore-errors (require 'sb-aclrepl))
    (when (find-package 'sb-aclrepl)
      (push :aclrepl cl:*features*))
    #+aclrepl
    (progn
      (setq sb-aclrepl:*max-history* 100)
      (setf (sb-aclrepl:alias "asdc")
            #'(lambda (sys) (asdf:operate 'asdf:compile-op sys)))
      (sb-aclrepl:alias "l" (sys) (asdf:operate 'asdf:load-op sys))
      (sb-aclrepl:alias "t" (sys) (asdf:operate 'asdf:test-op sys))
      ;; The 1 below means that two characaters ("up") are required
      (sb-aclrepl:alias ("up" 1 "Use package") (package) (use-package package))
      ;; The 0 below means only the first letter ("r") is required,
      ;; such as ":r base64"
      (sb-aclrepl:alias ("require" 0 "Require module") (sys) (require sys))
      (setq cl:*features* (delete :aclrepl cl:*features*)))))
